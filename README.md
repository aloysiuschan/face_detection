# smile_detection
The folder "annotations" contains XML files (generated by labelImg) with information on the bounding boxes in the training and test images.

The folder "data" contains CSV files with information on the bounding boxes in the training and test images, and TFRecord files with the same information.

The folder "images" contains the raw images used in this project.

The folder "training" contains the label map, object detection training pipeline, and exported model.

1) The Jupyter notebook "xml_to_csv.ipynb" condenses the information in the xml files to an overall CSV file called "smile_labels.csv".

2) The Jupyter notebook "draw boxes.ipynb" shows some of the images, with their bounding boxes.

3) The Jupyter notebook "split labels.ipynb" splits the overall CSV file ("smile_labels.csv") into a training set ("train_labels.csv") and a test set ("test_labels.csv").

4) The Python script "generate_tfrecord.py" uses the training and test CSV files to generate TFRecords containing the same information.
- To execute this script, open the Anaconda Prompt, then:

	cd C:\Users\USER\Desktop\customised object detection
	
	python generate_tfrecord.py --csv_input=data/train_labels.csv  --output_path=data/train.record --image_dir=images
	
	python generate_tfrecord.py --csv_input=data/test_labels.csv  --output_path=data/test.record --image_dir=images

5) The Python script "train.py" trains the object detection model, based on hyperparameters specified in "ssd_mobilenet_v1_pets.config", the label map "object-detection.pbtxt", and the TFRecords.
- To execute this script, open the Anaconda Prompt, then:

	cd C:\Users\USER\Desktop\customised object detection
	
	python train.py --logtostderr --train_dir=training/ --pipeline_config_path=training/ssd_mobilenet_v1_pets.config

6) The Python script "export_inference_graph.py" generates the trained model.
- To execute this script, open the Anaconda Prompt, then:

	cd C:\Users\USER\Desktop\customised object detection
	
	python export_inference_graph.py --input_type image_tensor --pipeline_config_path training/pipeline.config --trained_checkpoint_prefix training/model.ckpt-1000 --output_directory training/

7) The Jupyter notebook "object_detection_image.ipynb" uses the trained model to detect smiles in images.
